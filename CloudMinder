#!/usr/bin/env node

const os = require('os');
const express = require('express');
const app = express();

app.listen(2112, () => {
});


app.get("/status", (req, res, next) => {

  const averages = os.loadavg();
  const cpus = os.cpus();
  const totalmem = os.totalmem();
  const freemem = os.freemem();
  const freemempercent = freemem / totalmem * 100.0;
  const loadpercent = (averages[0] / cpus.length) * 100.0;

  res.json({
    hostname: os.hostname(),
    load: averages[0],
    loadpercent: loadpercent,
    cpus: cpus.length,
    uptime: os.uptime(),
    totalmem: totalmem,
    freemem: freemem,
    freemempercent: freemempercent
  });

});

